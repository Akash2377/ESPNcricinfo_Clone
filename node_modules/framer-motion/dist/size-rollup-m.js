import*as t from"react";import n,{createContext as e,useContext as r,useLayoutEffect as o,useEffect as a,useRef as i,useCallback as s,useMemo as c,forwardRef as l,createElement as u}from"react";const f=e({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),d=e({});const m=e(null),p="undefined"!=typeof document,g=p?o:a,y=e({strict:!1});function h(t,n,e,o){const s=r(d).visualElement,c=r(y),l=r(m),u=r(f).reducedMotion,p=i(void 0);o=o||c.renderer,!p.current&&o&&(p.current=o(t,{visualState:n,parent:s,props:e,presenceId:l?l.id:void 0,blockInitialAnimation:!!l&&!1===l.initial,reducedMotionConfig:u}));const h=p.current;return g(()=>{h&&h.syncRender()}),a(()=>{h&&h.animationState&&h.animationState.animateChanges()}),g(()=>()=>h&&h.notifyUnmount(),[]),h}function v(t,n,e){return s(r=>{var o;r&&t.mount&&t.mount(r),n&&(r?n.mount(r):n.unmount()),e&&("function"==typeof e?e(r):"object"==typeof(o=e)&&Object.prototype.hasOwnProperty.call(o,"current")&&(e.current=r))},[n])}function w(t){return"string"==typeof t||Array.isArray(t)}function b(t){return"object"==typeof t&&"function"==typeof t.start}const S=["initial","animate","exit","whileHover","whileDrag","whileTap","whileFocus","whileInView"];function x(t){return b(t.animate)||S.some(n=>w(t[n]))}function V(t){const{initial:n,animate:e}=function(t,n){if(x(t)){const{initial:n,animate:e}=t;return{initial:!1===n||w(n)?n:void 0,animate:w(e)?e:void 0}}return!1!==t.inherit?n:{}}(t,r(d));return c(()=>({initial:n,animate:e}),[O(n),O(e)])}function O(t){return Array.isArray(t)?t.join(" "):t}const T=t=>({isEnabled:n=>t.some(t=>!!n[t])}),C={measureLayout:T(["layout","layoutId","drag"]),animation:T(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView"]),exit:T(["exit"]),drag:T(["drag","dragControls"]),focus:T(["whileFocus"]),hover:T(["whileHover","onHoverStart","onHoverEnd"]),tap:T(["whileTap","onTap","onTapStart","onTapCancel"]),pan:T(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),inView:T(["whileInView","onViewportEnter","onViewportLeave"])};function E(t){const n=i(null);return null===n.current&&(n.current=t()),n.current}const P=!1;let k=1;const A=e({});class j extends n.Component{getSnapshotBeforeUpdate(){const{visualElement:t,props:n}=this.props;return t&&t.setProps(n),null}componentDidUpdate(){}render(){return this.props.children}}const L=e({});function M({preloadedFeatures:n,createVisualElement:e,projectionNodeConstructor:o,useRender:a,useVisualState:i,Component:s}){return n&&function(t){for(const n in t)"projectionNodeConstructor"===n?C.projectionNodeConstructor=t[n]:C[n].Component=t[n]}(n),l((function(c,l){const u={...r(f),...c,layoutId:R(c)},{isStatic:m}=u;let g=null;const w=V(c),b=m?void 0:E(()=>{if(P)return k++}),S=i(c,m);if(!m&&p){w.visualElement=h(s,S,u,e);const t=r(y).strict,a=r(L);w.visualElement&&(g=w.visualElement.loadFeatures(c,t,n,b,o||C.projectionNodeConstructor,a))}return t.createElement(j,{visualElement:w.visualElement,props:u},g,t.createElement(d.Provider,{value:w},a(s,c,b,v(S,w.visualElement,l),S,m,w.visualElement)))}))}function R({layoutId:t}){const n=r(A).id;return n&&void 0!==t?n+"-"+t:t}const D=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function B(t){return"string"==typeof t&&!t.includes("-")&&!!(D.indexOf(t)>-1||/[A-Z]/.test(t))}const W={},X=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","skew","skewX","skewY"],Y=new Set(X);function H(t,{layout:n,layoutId:e}){return Y.has(t)||t.startsWith("origin")||(n||void 0!==e)&&(!!W[t]||"opacity"===t)}const F=t=>void 0!==t&&!!t.getVelocity,I={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},$=(t,n)=>X.indexOf(t)-X.indexOf(n);function Z(t){return t.startsWith("--")}const z=(t,n)=>n&&"number"==typeof t?n.transform(t):t;const U={test:t=>"number"==typeof t,parse:parseFloat,transform:t=>t},K=Object.assign(Object.assign({},U),{transform:(N=0,q=1,t=>Math.max(Math.min(t,q),N))});var N,q;const _=Object.assign(Object.assign({},U),{default:1}),G=t=>({test:n=>function(t){return"string"==typeof t}(n)&&n.endsWith(t)&&1===n.split(" ").length,parse:parseFloat,transform:n=>`${n}${t}`}),J=G("deg"),Q=G("%"),tt=G("px"),nt=Object.assign(Object.assign({},Q),{parse:t=>Q.parse(t)/100,transform:t=>Q.transform(100*t)}),et={...U,transform:Math.round},rt={borderWidth:tt,borderTopWidth:tt,borderRightWidth:tt,borderBottomWidth:tt,borderLeftWidth:tt,borderRadius:tt,radius:tt,borderTopLeftRadius:tt,borderTopRightRadius:tt,borderBottomRightRadius:tt,borderBottomLeftRadius:tt,width:tt,maxWidth:tt,height:tt,maxHeight:tt,size:tt,top:tt,right:tt,bottom:tt,left:tt,padding:tt,paddingTop:tt,paddingRight:tt,paddingBottom:tt,paddingLeft:tt,margin:tt,marginTop:tt,marginRight:tt,marginBottom:tt,marginLeft:tt,rotate:J,rotateX:J,rotateY:J,rotateZ:J,scale:_,scaleX:_,scaleY:_,scaleZ:_,skew:J,skewX:J,skewY:J,distance:tt,translateX:tt,translateY:tt,translateZ:tt,x:tt,y:tt,z:tt,perspective:tt,transformPerspective:tt,opacity:K,originX:nt,originY:nt,originZ:tt,zIndex:et,fillOpacity:K,strokeOpacity:K,numOctaves:et};function ot(t,n,e,r){const{style:o,vars:a,transform:i,transformKeys:s,transformOrigin:c}=t;s.length=0;let l=!1,u=!1,f=!0;for(const t in n){const e=n[t];if(Z(t)){a[t]=e;continue}const r=rt[t],d=z(e,r);if(Y.has(t)){if(l=!0,i[t]=d,s.push(t),!f)continue;e!==(r.default||0)&&(f=!1)}else t.startsWith("origin")?(u=!0,c[t]=d):o[t]=d}if(l||r?o.transform=function({transform:t,transformKeys:n},{enableHardwareAcceleration:e=!0,allowTransformNone:r=!0},o,a){let i="";n.sort($);for(const e of n)i+=`${I[e]||e}(${t[e]}) `;return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),a?i=a(t,o?"":i):r&&o&&(i="none"),i}(t,e,f,r):!n.transform&&o.transform&&(o.transform="none"),u){const{originX:t="50%",originY:n="50%",originZ:e=0}=c;o.transformOrigin=`${t} ${n} ${e}`}}const at=()=>({style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}});function it(t,n,e){for(const r in n)F(n[r])||H(r,e)||(t[r]=n[r])}function st(t,n,e){const r={};return it(r,t.style||{},t),Object.assign(r,function({transformTemplate:t},n,e){return c(()=>{const r={style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}};return ot(r,n,{enableHardwareAcceleration:!e},t),Object.assign({},r.vars,r.style)},[n])}(t,n,e)),t.transformValues?t.transformValues(r):r}function ct(t,n,e){const r={},o=st(t,n,e);return t.drag&&!1!==t.dragListener&&(r.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=!0===t.drag?"none":"pan-"+("x"===t.drag?"y":"x")),r.style=o,r}const lt=new Set(["initial","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","layoutDependency","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","dragSnapToOrigin","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","onHoverStart","onHoverEnd","layoutScroll","whileInView","onViewportEnter","onViewportLeave","viewport","whileTap","onTap","onTapStart","onTapCancel","animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag","whileInView","onPan","onPanStart","onPanSessionStart","onPanEnd"]);function ut(t){return lt.has(t)}let ft=t=>!ut(t);try{(dt=require("@emotion/is-prop-valid").default)&&(ft=t=>t.startsWith("on")?!ut(t):dt(t))}catch(t){}var dt;function mt(t,n,e){return"string"==typeof t?t:tt.transform(n+e*t)}const pt={offset:"stroke-dashoffset",array:"stroke-dasharray"},gt={offset:"strokeDashoffset",array:"strokeDasharray"};function yt(t,{attrX:n,attrY:e,originX:r,originY:o,pathLength:a,pathSpacing:i=1,pathOffset:s=0,...c},l,u){ot(t,c,l,u),t.attrs=t.style,t.style={};const{attrs:f,style:d,dimensions:m}=t;f.transform&&(m&&(d.transform=f.transform),delete f.transform),m&&(void 0!==r||void 0!==o||d.transform)&&(d.transformOrigin=function(t,n,e){return`${mt(n,t.x,t.width)} ${mt(e,t.y,t.height)}`}(m,void 0!==r?r:.5,void 0!==o?o:.5)),void 0!==n&&(f.x=n),void 0!==e&&(f.y=e),void 0!==a&&function(t,n,e=1,r=0,o=!0){t.pathLength=1;const a=o?pt:gt;t[a.offset]=tt.transform(-r);const i=tt.transform(n),s=tt.transform(e);t[a.array]=`${i} ${s}`}(f,a,i,s,!1)}const ht=()=>({style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{},attrs:{}});function vt(t,n){const e=c(()=>{const e={style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{},attrs:{}};return yt(e,n,{enableHardwareAcceleration:!1},t.transformTemplate),{...e.attrs,style:{...e.style}}},[n]);if(t.style){const n={};it(n,t.style,t),e.style={...n,...e.style}}return e}function wt(t=!1){return(n,e,r,o,{latestValues:a},i)=>{const s=(B(n)?vt:ct)(e,a,i),c={...function(t,n,e){const r={};for(const o in t)(ft(o)||!0===e&&ut(o)||!n&&!ut(o)||t.draggable&&o.startsWith("onDrag"))&&(r[o]=t[o]);return r}(e,"string"==typeof n,t),...s,ref:o};return r&&(c["data-projection-id"]=r),u(n,c)}}const bt=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength"]);function St(t,n,e,r){!function(t,{style:n,vars:e},r,o){Object.assign(t.style,n,o&&o.getProjectionStyles(r));for(const n in e)t.style.setProperty(n,e[n])}(t,n,void 0,r);for(const e in n.attrs)t.setAttribute(bt.has(e)?e:e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n.attrs[e])}function xt(t){const{style:n}=t,e={};for(const r in n)(F(n[r])||H(r,t))&&(e[r]=n[r]);return e}function Vt(t){const n=F(t)?t.get():t;return e=n,Boolean(e&&"object"==typeof e&&e.mix&&e.toValue)?n.toValue():n;var e}const Ot=t=>(n,e)=>{const o=r(d),a=r(m),i=()=>function({scrapeMotionValuesFromProps:t,createRenderState:n,onMount:e},r,o,a){const i={latestValues:Tt(r,o,a,t),renderState:n()};return e&&(i.mount=t=>e(r,t,i)),i}(t,n,o,a);return e?i():E(i)};function Tt(t,n,e,r){const o={},a=r(t);for(const t in a)o[t]=Vt(a[t]);let{initial:i,animate:s}=t;const c=x(t),l=function(t){return Boolean(x(t)||t.variants)}(t);n&&l&&!c&&!1!==t.inherit&&(void 0===i&&(i=n.initial),void 0===s&&(s=n.animate));let u=!!e&&!1===e.initial;u=u||!1===i;const f=u?s:i;if(f&&"boolean"!=typeof f&&!b(f)){(Array.isArray(f)?f:[f]).forEach(n=>{const e=function(t,n,e,r={},o={}){return"function"==typeof n&&(n=n(void 0!==e?e:t.custom,r,o)),"string"==typeof n&&(n=t.variants&&t.variants[n]),"function"==typeof n&&(n=n(void 0!==e?e:t.custom,r,o)),n}(t,n);if(!e)return;const{transitionEnd:r,transition:a,...i}=e;for(const t in i){let n=i[t];if(Array.isArray(n)){n=n[u?n.length-1:0]}null!==n&&(o[t]=n)}for(const t in r)o[t]=r[t]})}return o}const Ct={useVisualState:Ot({scrapeMotionValuesFromProps:function(t){const n=xt(t);for(const e in t)if(F(t[e])){n["x"===e||"y"===e?"attr"+e.toUpperCase():e]=t[e]}return n},createRenderState:ht,onMount:(t,n,{renderState:e,latestValues:r})=>{try{e.dimensions="function"==typeof n.getBBox?n.getBBox():n.getBoundingClientRect()}catch(t){e.dimensions={x:0,y:0,width:0,height:0}}yt(e,r,{enableHardwareAcceleration:!1},t.transformTemplate),St(n,e)}})},Et={useVisualState:Ot({scrapeMotionValuesFromProps:xt,createRenderState:at})};const Pt=function(t){function n(n,e={}){return M(t(n,e))}if("undefined"==typeof Proxy)return n;const e=new Map;return new Proxy(n,{get:(t,r)=>(e.has(r)||e.set(r,n(r)),e.get(r))})}((function(t,{forwardMotionProps:n=!1},e,r,o){return{...B(t)?Ct:Et,preloadedFeatures:e,useRender:wt(n),createVisualElement:r,projectionNodeConstructor:o,Component:t}}));export{Pt as m};
